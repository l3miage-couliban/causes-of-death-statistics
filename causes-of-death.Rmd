---
title: "Causes of death in the world"
author: "N'Djo-Soro Coulibaly, Ciré Keïta, Higo Aragao, Thi Tran"
date: "2024-03-05"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

## Context of the problem
  Il est question d'analyser des données concernant les causes de mortalité dans le monde. Pour mener à bien cette analyse, nous avons defini des questions sur lesquelles travailler:
  2) Les 10 principales causes de mort dans le monde ? 
    - Quelle décision prendre à partir du résultat
  3) Les 5 principales causes sur chaque continent ? 
  4) L'évolution des décès au fil des années (2007 - 2019) ?
  5) representation graphique map
  6) Ajout des données démographiques


## Comment les données ont-elles été recuillies ?
Les données proviennent de Our World In Data
Source: https://www.kaggle.com/datasets/ivanchvez/causes-of-death-our-world-in-data



D'autres questions pourront être ajoutées au fur et à mesure pour plus de précisions et d'interprétations


## Read Dataset

```{r}
library(tidyverse)
library(maps)
library(ggplot2)
library(ggplot2)
theme_set(
  theme_bw() 
  )

CausesData <- read_csv("20222703-causes-f-death-clean-output-v2.0.csv") %>%
  rename(iso_code=Code) %>%
  filter(Year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```


```{r}
CountriesData <- read_csv("owid-co2-data.csv") %>%
  select(year, iso_code, population, gdp) %>%
  filter(year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```

```{r}
ContinentsData <- read_csv("continents2.csv") %>%
  select('alpha-3', region, 'sub-region') %>%
  rename(iso_code='alpha-3') %>%
  filter(!is.na(region));
nbSousRegion <- ContinentsData %>%
  distinct(`sub-region`)
```

## join both dataframes
```{r}
#data <- merge(CausesData, CountriesData, by="iso_code");
data <- left_join(CausesData, CountriesData, by=c("iso_code"="iso_code", "Year"="year")) %>%
  left_join(ContinentsData, by=c("iso_code"="iso_code")) %>%
  arrange(Year);
```


## 10 firsts Number of deaths by cause
%>%
  group_by(`Causes name`) %>%
  summarize(n=sum(as.numeric(`Death Numbers`)))
  
```{r}
ndc <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(10)
```

## 5 firsts causes of death on each continent
```{r}
area <- data %>%
  filter(is.na(iso_code))
  filter(Entity="")
```

#### MES MODIFICATIONS
## Asia
```{r}
asia <- data %>%
filter(region == "Asia")  %>%
group_by(Year) %>%
distinct(population, Entity) %>%
summarise(populationTotal = sum(population))
ggplot(data  = asia, shape = populationTotal) +
  aes(x = Year) +
  aes(y = populationTotal / 10000000) +
  aes(color = populationTotal) +
  geom_line() +
  scale_x_continuous(breaks = seq(1990,2019, by = 2))

```

```{r}
# Charger les données pour le monde
world <- map_data("world") 


# Fusionner les données de population avec les données de la carte du monde en utilisant un left join

pays <- data %>% distinct(Entity)
world_with_population <- merge(pays, world, by.x = "Entity", by.y = "region", all.x = TRUE)

# Créer la carte
ggplot() + 
  geom_polygon(data = world, aes(x = long, y = lat, group = group), 
               fill = "lightblue", color = "black")



```

##### DONNÉES DES SOUS REGIONS ################################
#### Region Sub-Sahara Africa

```{r}
RegionSubSaharaAfrica <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Sub-Saharan Africa") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(6)
ggplot(data = RegionSubSaharaAfrica, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité") 
```

#### Region Northen Africa
```{r}
RegionNorthenAfrica <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Northern Africa") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionNorthenAfrica, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité") 
```
#### Region Western Europe
```{r}
RegionWesternEurope <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Western Europe") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionWesternEurope, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```
#### Region Northen Europe
```{r}
RegionNorthenEurope <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Northern Europe") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionNorthenEurope, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```

#### Region Southern Asia
```{r}
RegionSouthernAsia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Southern Asia") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) /1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionSouthernAsia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```

#### Region Western Asia
```{r}
RegionWesternAsia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Western Asia") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionWesternAsia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```

#### Region South-eastern Asia
```{r}
RegionSouthEasternAsia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="South-eastern Asia") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionSouthEasternAsia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```
#### Region Eastern Asia
```{r}
RegionEasternAsia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Eastern Asia") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)) / 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(6)
ggplot(data = RegionEasternAsia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```
#### Region Central Asia
```{r}
RegionCentralAsia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Central Asia") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`)/1000000)) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(6)
ggplot(data = RegionCentralAsia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```
#### Region Latin America and the Caribbean
```{r}
RegionLatinAmericaCaribbean <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Latin America and the Caribbean") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))/ 1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(6)
ggplot(data = RegionLatinAmericaCaribbean, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```

#### Region Northern America
```{r}
RegionNorthernAmerica <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Northern America") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))/1000000) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionNorthernAmerica, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès en millions", title = "Nombre de décès par cause de mortalité")
```

#### Region Australia and New Zealand
```{r}
RegionAustralia <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Australia and New Zealand") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
ggplot(data = RegionAustralia, aes(y = `Causes name`, x = `Death Numbers`, color = `Causes name`)) +
  geom_bar(stat = "identity", fill = "white") +
  labs(y = "Cause de mortalité", x = "Nombre de décès", title = "Nombre de décès par cause de mortalité") +
  theme(axis.text.x = element_text(angle = 5, hjust = 1))
```



#### NUAGES DE POINTS

#### Sub-Sahara Africa en 2016
#### A la sortie de l'épidémie d'Ebola qui a sévi en Afrique de l'Ouest, principalement en Guinée, au Liberia et en #### Sierra Leone, a été l'une des plus graves de l'histoire de la maladie. Elle a également touché d'autres pays de #### la région, bien que dans une moindre mesure.
```{r}
subSahara2015 <- data %>%
filter(`sub-region` == "Sub-Saharan Africa")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(Year == 2015) %>%
filter(!is.na(`Death Numbers`))%>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`))%>%
  top_n(5);

subSahara2 <- data %>%
filter(`sub-region` == "Sub-Saharan Africa")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(!is.na(`Death Numbers`))%>%
filter(Year == 2015) %>%
  distinct(Entity, population, gdp) %>%
  summarise(PIB = sum(gdp), population = sum(population))

PIB_total <- sum(subSahara2$PIB) / 1000000000000000
total_population <- sum(subSahara2$population)
total_deces <- sum(subSahara2015$`Death Numbers`)

taux_mortalite = total_deces / total_population

ratio_deces_par_cause <- subSahara2015$`Death Numbers` / total_deces


ggplot(subSahara2015, aes(x = PIB_total, y = taux_mortalite, shape = `Causes name`, color = ratio_deces_par_cause))+
  geom_point(position = position_jitter(width = 0.3, height = 0.3), size = 2) +
  labs(x = "PIB total de la sous-région", y = "Taux de mortalité", color = "Ratio de décès par cause") 

```

#### Nuages de points
#### Western Europe en 2010
#### 2009 - 2010 une période qui pourrait être considérée comme particulièrement significative en Europe occidentale #### est celle de la pandémie de grippe H1N1 
```{r}
westernEurope2010 <- data %>%
filter(`sub-region` == "Western Europe")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(Year == 2010) %>%
filter(!is.na(`Death Numbers`))%>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`))%>%
  top_n(5);

westernEurope2 <- data %>%
filter(`sub-region` == "Western Europe")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(!is.na(`Death Numbers`))%>%
filter(Year == 2010) %>%
  distinct(Entity, population, gdp) %>%
  summarise(PIB = sum(gdp), population = sum(population))

PIB_total <- sum(westernEurope2$PIB) / 1000000000000000
total_population <- sum(westernEurope2$population)
total_deces <- sum(westernEurope2010$`Death Numbers`)

taux_mortalite = total_deces / total_population

ratio_deces_par_cause <- westernEurope2010$`Death Numbers` / total_deces


ggplot(subSahara2015, aes(x = PIB_total, y = taux_mortalite, shape = `Causes name`, color = ratio_deces_par_cause))+
  geom_point(position = position_jitter(width = 0.3, height = 0.3), size = 2) +
  labs(x = "PIB total de la sous-région", y = "Taux de mortalité", color = "Ratio de décès par cause") 

```

#### Nuages de points
#### Eastern Asia en 2003
#### Une période qui pourrait être considérée comme particulièrement critique pour l'Asie de l'Est est celle 
#### de l'épidémie de syndrome respiratoire aigu sévère (SRAS) en 2002-2003. Le SRAS, causé par un coronavirus, a #### émergé en Chine continentale en novembre 2002 avant de se propager rapidement à d'autres pays de la région et #### au-delà.
```{r}
easternAsia2003 <- data %>%
filter(`sub-region` == "Eastern Asia")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(Year == 2003) %>%
filter(!is.na(`Death Numbers`))%>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`))%>%
  top_n(5);

easternAsia2 <- data %>%
filter(`sub-region` == "Eastern Asia")  %>%
group_by(Year)%>%
filter(!is.na(gdp)) %>%
filter(!is.na(`Death Numbers`))%>%
filter(Year == 2003) %>%
  distinct(Entity, population, gdp) %>%
  summarise(PIB = sum(gdp), population = sum(population))

PIB_total <- sum(easternAsia2$PIB) / 1000000000
total_population <- sum(easternAsia2$population)
total_deces <- sum(easternAsia2003$`Death Numbers`) 

taux_mortalite = (total_deces / total_population) 

ratio_deces_par_cause <- (easternAsia2003$`Death Numbers` / total_deces)  


ggplot(easternAsia2003, aes(x = PIB_total, y = taux_mortalite, shape = `Causes name`, color = ratio_deces_par_cause))+
  geom_point(position = position_jitter(width = 0.3, height = 0.3), size = 2) +
  labs(x = "PIB total de la sous-région en milliards", y = "Taux de mortalité en pourcentage", color = "Ratio de décès par cause") 
```
