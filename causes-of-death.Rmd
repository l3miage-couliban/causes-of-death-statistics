---
title: "Causes of death in the world"
author: "N'Djo-Soro Coulibaly, Ciré Keïta, Higo Aragao, Thi Tran"
date: "2024-03-05"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

## Context of the problem
  Il est question d'analyser des données concernant les causes de mortalité dans le monde. Pour mener à bien cette analyse, nous avons defini des questions sur lesquelles travailler:
  2) Les 10 principales causes de mort dans le monde ? 
    - Quelle décision prendre à partir du résultat
  3) Les 5 principales causes sur chaque continent ? 
  4) L'évolution des décès au fil des années (2007 - 2019) ?
  5) representation graphique map
  6) Ajout des données démographiques


## Comment les données ont-elles été recuillies ?
Les données proviennent de Our World In Data
Source: https://www.kaggle.com/datasets/ivanchvez/causes-of-death-our-world-in-data



D'autres questions pourront être ajoutées au fur et à mesure pour plus de précisions et d'interprétations


## Read Dataset

```{r}
library(tidyverse)

CausesData <- read_delim("20222703-causes-f-death-clean-output-v2.0.csv", delim=",") %>%
  rename(iso_code=Code) %>%
  filter(Year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```


```{r}
CountriesData <- read_delim("owid-co2-data.csv",delim=",") %>%
  select(year, iso_code, population, gdp) %>%
  filter(year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```

```{r}
ContinentsData <- read_csv("continents2.csv") %>%
  select('alpha-3', region,'sub-region') %>%
  rename(iso_code='alpha-3') %>%
  filter(!is.na(region));
```

## join both dataframes
```{r}
#data <- merge(CausesData, CountriesData, by="iso_code");
data <- left_join(CausesData, CountriesData, by=c("iso_code"="iso_code", "Year"="year")) %>%
  left_join(ContinentsData, by=c("iso_code"="iso_code")) %>%
  arrange(Year);
```


## 10 firsts Number of deaths by cause
%>%
  group_by(`Causes name`) %>%
  summarize(n=sum(as.numeric(`Death Numbers`)))
  
```{r}
ndc <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(10)

pop_population <- data[c("region", "population")]
```




## The évolution population of each continent
```{r}

asian_data <- data %>%
  filter(region == "Asia") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = asian_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Asia", x = "Year", y = "Total Population")

```

```{r}
americas_data <- data %>%
  filter(region == "Americas") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = americas_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Americas", x = "Year", y = "Total Population")
```


```{r}

Europe_data <- data %>%
  filter(region == "Europe") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Europe_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Europe", x = "Year", y = "Total Population")
```

```{r}

Africa_data <- data %>%
  filter(region == "Africa") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Africa_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Africa", x = "Year", y = "Total Population")
```

```{r}
Oceania_data <- data %>%
  filter(region == "Oceania") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Oceania_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Oceania", x = "Year", y = "Total Population")
```





```{r}
# Calculer le pourcentage de décès par rapport à la population
filtered_data <- data %>%
  filter(!is.na(region) & !is.na(Year) & !is.na(population) & !is.na(`Death Numbers`)) %>%
  mutate(DeathPercentage = (`Death Numbers` / population) * 100)

# Tracer les données avec ggplot
ggplot(filtered_data, aes(x = Year, y = DeathPercentage)) +
  geom_line() + # Utiliser geom_line pour tracer une ligne
  facet_wrap(~ region, scales = "free_y") + # Séparer par région avec des échelles Y libres
  labs(
    title = "Death Percentage of Population by Region",
    x = "Year",
    y = "Death Percentage"
  ) +
  theme_minimal() # Utiliser un thème minimaliste


```



## Sub-Continent

```{r}
#
ndc <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region`=="Sub-Saharan Africa") %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(5)
```


#These sub region of each continent with 5 death causes populars

#####    Asie (5 sub): Central Asia, Eastern Asia, South-eastern Asia, Southern Asia and Western Asia
```{r}
sousRegionAsie<- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(region=="Asia") %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers=sum(as.numeric(`Death Numbers`))) %>%
              arrange(`sub-region`, desc(Death_numbers)) %>%
  group_by(`sub-region`) %>%
  slice_max(order_by = Death_numbers, n=5)



RegionCentralAsia <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Central Asia")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionCentralAsia, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Central Asia",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)



RegionEasternAsia <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Eastern Asia")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionEasternAsia, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Eastern Asia",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)



RegionSoutheasternAsia <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("South-eastern Asia")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionSoutheasternAsia, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in South-eastern Asia",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)


RegionSouthernAsia <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Southern Asia")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionSouthernAsia, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Southern Asia",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)


RegionWesternAsia <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Western Asia")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionWesternAsia, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Western Asia",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)






  
```
##### Europe (2 sub) : Northern Europe and Southern Europe

```{r}
RegionNorthernEurope <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Northern Europe")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionNorthernEurope, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Northern Europe",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)




RegionSouthernEurope <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Southern Europe")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionSouthernEurope, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Southern Europe",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)




```

##### Africa (2-sub): Northern Africa and Sub-Saharan Africa
```{r}
RegionNorthernAfrica <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Northern Africa")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionNorthernAfrica, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Northern Africa",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)


RegionSubSaharan <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Sub-Saharan Africa")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionSubSaharan, aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Sub-Saharan Africa",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)



```






##### Americas (2-sub): Northern America and Latin America and the Caribbean
```{r}
sousRegionAmericas<- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(region=="Americas") %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers=sum(as.numeric(`Death Numbers`))) %>%
              arrange(`sub-region`, desc(Death_numbers)) %>%
  group_by(`sub-region`) %>%
  slice_max(order_by = Death_numbers, n=5)


RegionLatinAndCari <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Latin America and the Caribbean")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionLatinAndCari , aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Latin America and the Caribbean",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)


RegionNorthernAmerica <- data %>%
  filter(!is.na(`Death Numbers`)) %>%
  filter(`sub-region` == c("Northern America")) %>%
  group_by(`sub-region`, `Causes name`) %>%
  summarise(Death_numbers = sum(as.numeric(`Death Numbers`)/1000000, na.rm = TRUE)) %>%
  arrange(`sub-region`, desc(Death_numbers)) %>%
  slice_max(order_by = Death_numbers, n = 5)

ggplot(RegionNorthernAmerica , aes(x=`Causes name`, y=Death_numbers, fill=`Causes name`)) +
  geom_bar(stat="identity") +
 
  theme_minimal() + 
  labs(title="Top 5 Causes of Death in Northern America",
       x="Cause of Death",
       y="Number of Deaths million") +
  coord_flip()+
  guides(fill=FALSE)




```



