---
title: "Causes of death in the world"
author: "N'Djo-Soro Coulibaly, Ciré Keïta, Higo Aragao, Thi Tran"
date: "2024-03-05"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

## Context of the problem
  Il est question d'analyser des données concernant les causes de mortalité dans le monde. Pour mener à bien cette analyse, nous avons defini des questions sur lesquelles travailler:
  2) Les 10 principales causes de mort dans le monde ? 
    - Quelle décision prendre à partir du résultat
  3) Les 5 principales causes sur chaque continent ? 
  4) L'évolution des décès au fil des années (2007 - 2019) ?
  5) representation graphique map
  6) Ajout des données démographiques


## Comment les données ont-elles été recuillies ?
Les données proviennent de Our World In Data
Source: https://www.kaggle.com/datasets/ivanchvez/causes-of-death-our-world-in-data



D'autres questions pourront être ajoutées au fur et à mesure pour plus de précisions et d'interprétations


## Read Dataset

```{r}
library(tidyverse)

CausesData <- read_delim("20222703-causes-f-death-clean-output-v2.0.csv", delim=",") %>%
  rename(iso_code=Code) %>%
  filter(Year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```


```{r}
CountriesData <- read_delim("owid-co2-data.csv",delim=",") %>%
  select(year, iso_code, population, gdp) %>%
  filter(year %in% 1990:2019) %>%
  filter(!is.na(iso_code));
```

```{r}
ContinentsData <- read_delim("continents2.csv",delim=",") %>%
  select('alpha-3', region) %>%
  rename(iso_code='alpha-3') %>%
  filter(!is.na(region));
```

## join both dataframes
```{r}
#data <- merge(CausesData, CountriesData, by="iso_code");
data <- left_join(CausesData, CountriesData, by=c("iso_code"="iso_code", "Year"="year")) %>%
  left_join(ContinentsData, by=c("iso_code"="iso_code")) %>%
  arrange(Year);
```


## 10 firsts Number of deaths by cause
%>%
  group_by(`Causes name`) %>%
  summarize(n=sum(as.numeric(`Death Numbers`)))
  
```{r}
ndc <- data %>%
  filter(!is.na(iso_code)) %>%
  filter(!is.na(`Death Numbers`)) %>%
  group_by(`Causes name`) %>%
  summarize(`Death Numbers`=sum(as.numeric(`Death Numbers`))) %>%
  arrange(desc(`Death Numbers`)) %>%
  top_n(10)
```

## 5 firsts causes of death on each continent
```{r}

asian_data <- data %>%
  filter(region == "Asia") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = asian_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Asia", x = "Year", y = "Total Population")

```

```{r}
americas_data <- data %>%
  filter(region == "Americas") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = americas_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Americas", x = "Year", y = "Total Population")
```
```{r}

Europe_data <- data %>%
  filter(region == "Europe") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Europe_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Europe", x = "Year", y = "Total Population")
```

```{r}

Africa_data <- data %>%
  filter(region == "Africa") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Africa_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Africa", x = "Year", y = "Total Population")
```

```{r}
Oceania_data <- data %>%
  filter(region == "Oceania") %>%
  group_by(Year) %>%
  summarise(
    total_deaths = sum(`Death Numbers`, na.rm = TRUE), # Sum of deaths, removing NAs
    total_population = sum(population, na.rm = TRUE) # Sum of population, removing NAs
  )

# Now, plot the total_population over time
ggplot(data = Oceania_data, aes(x = Year, y = total_population)) +
  geom_line() +
  theme_minimal() +
  labs(title = "Population Evolution in Oceania", x = "Year", y = "Total Population")
```




```{r}

filtered_data <- data %>%
  filter(!is.na(region) & !is.na(Year) & !is.na(population))


ggplot(data = filtered_data, aes(x = Year, y = `Death Numbers`)) + 
  geom_line() + 
  facet_wrap(~ region, scales = "free_y") + 
  labs(
    title = "Population Trends by Region",
    x = "Year",
    y = "Population"
  ) +
  theme_minimal()


```

